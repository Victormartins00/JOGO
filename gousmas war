#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define MAX_FURY 5
#define MAX_GOUSMAS 2


typedef struct Gousma {
    int fury;
} Gousma;


typedef struct Player {
    Gousma gousmas[MAX_GOUSMAS];
    int active_gousma;
} Player;


void print_game_status(Player player1, Player player2) {
    printf("Player 1: Gousma 1 (%d/%d), Gousma 2 (%d/%d)\n", player1.gousmas[0].fury, MAX_FURY, player1.gousmas[1].fury, MAX_FURY);
    printf("Player 2: Gousma 1 (%d/%d), Gousma 2 (%d/%d)\n", player2.gousmas[0].fury, MAX_FURY, player2.gousmas[1].fury, MAX_FURY);
}


int choose_starting_player() {
    srand(time(NULL));
    return rand() % 2 + 1;
}


int check_active_gousmas(Player player) {
    for (int i = 0; i < MAX_GOUSMAS; i++) {
        if (player.gousmas[i].fury > 0) {
            return 1;
        }
    }
    return 0;
}


void check_max_fury(Gousma* gousma) {
    if (gousma->fury >= MAX_FURY) {
        printf("Gousma with fury %d foi desintegrado!\n", gousma->fury);
        gousma->fury = 0;
    }
}


int select_target_gousma(Player player) {
    int target_gousma;
    do {
        printf("Select target Gousma (1 or 2): ");
        scanf("%d", &target_gousma);
    } while (target_gousma < 1 || target_gousma > MAX_GOUSMAS || target_gousma == player.active_gousma);
    return target_gousma - 1;
}


void attack(Player* attacker, Player* defender) {
    int target_gousma = select_target_gousma(*defender);
    defender->gousmas[target_gousma].fury += attacker->gousmas[attacker->active_gousma].fury;
    attacker->gousmas[attacker->active_gousma].fury = 0;
    check_max_fury(&defender->gousmas[target_gousma]);
    if (defender->gousmas[target_gousma].fury >= MAX_FURY) {
        defender->gousmas[target_gousma].fury = 0;
    }
}


void divide(Player* player) {
    if (player->gousmas[1].fury == 0 && player->gousmas[0].fury > 1) {
        player->gousmas[1].fury = player->gousmas[0].fury / 2;
player->gousmas[0].fury -= player->gousmas[1].fury;
printf("Gousma 1 divided into two Gousmas with fury %d and %d!\n", player->gousmas[0].fury, player->gousmas[1].fury);
} else {
printf("Division failed!\n");
}
}

int main() {

Player player1 = {{MAX_FURY, MAX_FURY}, 0};
Player player2 = {{MAX_FURY, MAX_FURY}, 0};
int current_player = choose_starting_player();
printf("Player %d starts the game!\n", current_player);



while (check_active_gousmas(player1) && check_active_gousmas(player2)) {
    
    printf("\n-- Turn of Player %d --\n", current_player);
    printf("Current Gousma: %d\n", current_player == 1 ? player1.active_gousma + 1 : player2.active_gousma + 1);
    print_game_status(player1, player2);

    
    int action;
    do {
        printf("escolha uma ação (1 - attack, 2 - divide): ");
        scanf("%d", &action);
    } while (action < 1 || action > 2);

    
    if (action == 1) {
        attack(current_player == 1 ? &player1 : &player2, current_player == 1 ? &player2 : &player1);
    } else {
        divide(current_player == 1 ? &player1 : &player2);
    }

    
    if (current_player == 1) {
        player1.active_gousma = (player1.active_gousma + 1) % MAX_GOUSMAS;
        current_player = 2;
    } else {
        player2.active_gousma = (player2.active_gousma + 1) % MAX_GOUSMAS;
        current_player = 1;
    }
}

// Print game result
if (!check_active_gousmas(player1)) {
    printf("\nPlayer 2 venceu!\n");
} else {
    printf("\nPlayer 1 venceu!\n");
}

return 0;
}

